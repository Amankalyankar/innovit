<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sarpanch Portal | GRAM-SABHA</title>
    <meta name="description" content="Administrative portal for village Sarpanch ‚Äî manage projects, budgets, approvals and community issues">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/mobile.css">
    <link rel="stylesheet" href="css/sarpanch.css">
</head>
<body>
<div class="sp-layout">

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     SIDEBAR
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<aside class="sp-sidebar" aria-label="Sarpanch portal sidebar">
    <a href="index.html" class="sp-sidebar-logo">
        <div class="sp-logo-icon" aria-hidden="true">
            <span class="material-symbols-outlined">account_balance</span>
        </div>
        <div>
            <p class="sp-logo-name">GRAM-SABHA</p>
            <p class="sp-logo-sub">Sarpanch Portal</p>
        </div>
    </a>

    <nav class="sp-nav" aria-label="Main navigation">
        <p class="sp-nav-section">Dashboard</p>

        <a href="sarpanch-portal.html" class="sp-nav-item active" aria-current="page">
            <span class="material-symbols-outlined" aria-hidden="true">dashboard</span>
            Overview
        </a>

        <p class="sp-nav-section">Management</p>

        <a href="pending-approvals.html" class="sp-nav-item">
            <span class="material-symbols-outlined" aria-hidden="true">task_alt</span>
            Pending Approvals
            <span class="sp-nav-badge" aria-label="5 pending approvals">5</span>
        </a>
        <a href="active-projects.html" class="sp-nav-item">
            <span class="material-symbols-outlined" aria-hidden="true">construction</span>
            Active Projects
        </a>
        <a href="public-ledger.html" class="sp-nav-item">
            <span class="material-symbols-outlined" aria-hidden="true">account_balance_wallet</span>
            Budget &amp; Funds
        </a>
        <a href="community-issues.html" class="sp-nav-item">
            <span class="material-symbols-outlined" aria-hidden="true">campaign</span>
            Community Issues
            <span class="sp-nav-badge issues" aria-label="12 community issues">12</span>
        </a>

        <p class="sp-nav-section">Operations</p>

        <a href="contractor-verification.html" class="sp-nav-item">
            <span class="material-symbols-outlined" aria-hidden="true">verified</span>
            Work Verification
        </a>
        <a href="contractors.html" class="sp-nav-item">
            <span class="material-symbols-outlined" aria-hidden="true">groups</span>
            Contractors
        </a>
    </nav>

    <div class="sp-sidebar-footer">
        <div class="sp-user-tile">
            <div class="sp-user-avatar" id="sidebarAvatar" aria-hidden="true">RK</div>
            <div style="flex:1;min-width:0">
                <p class="sp-user-name" id="sidebarUserName">Ramesh Kumar</p>
                <p class="sp-user-role">Sarpanch</p>
            </div>
            <button class="sp-logout-btn" onclick="GramSabha.logout()" aria-label="Logout">
                <span class="material-symbols-outlined" aria-hidden="true">logout</span>
            </button>
        </div>
    </div>
</aside>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     MAIN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<main class="sp-main">

    <!-- Top bar -->
    <header class="sp-topbar">
        <div class="sp-topbar-left">
            <h1 id="greetingText">Good Morning, Sarpanch Ji!</h1>
            <p id="dateText">Loading date‚Ä¶</p>
        </div>
        <div class="sp-topbar-right">
            <div class="sp-village-pill">
                <span class="material-symbols-outlined" aria-hidden="true">location_on</span>
                <span id="villageBadge">Rampur Village</span>
            </div>
            <button class="sp-notif-btn" aria-label="Notifications">
                <span class="material-symbols-outlined" aria-hidden="true">notifications</span>
                <span class="sp-notif-dot" aria-hidden="true"></span>
            </button>
        </div>
    </header>

    <!-- Body -->
    <div class="sp-body">

        <!-- ‚îÄ‚îÄ Hero ‚îÄ‚îÄ -->
        <section class="sp-hero" aria-label="Welcome hero">
            <div style="position:relative;z-index:1">
                <div class="sp-hero-badge">
                    <span class="material-symbols-outlined" aria-hidden="true">verified_user</span>
                    Verified Sarpanch
                </div>
                <h2 class="sp-hero-name" id="heroName">Namaste, Ramesh Kumar Ji üôè</h2>
                <p class="sp-hero-sub">Your village depends on your decisions. 5 approvals are waiting and 12 issues need attention today.</p>
                <div class="sp-hero-meta">
                    <span class="sp-hero-chip">
                        <span class="material-symbols-outlined" aria-hidden="true">account_balance</span>
                        Panchayat Code: RJ-JP-RMP-001
                    </span>
                    <span class="sp-hero-chip">
                        <span class="material-symbols-outlined" aria-hidden="true">calendar_today</span>
                        FY 2024‚Äì25
                    </span>
                    <span class="sp-hero-chip">
                        <span class="material-symbols-outlined" aria-hidden="true">people</span>
                        4,812 Villagers
                    </span>
                </div>
            </div>
            <div class="sp-hero-ctas">
                <a href="pending-approvals.html" class="sp-cta-btn primary">
                    <span class="material-symbols-outlined" aria-hidden="true">task_alt</span>
                    Review Approvals
                </a>
                <a href="community-issues.html" class="sp-cta-btn ghost">
                    <span class="material-symbols-outlined" aria-hidden="true">campaign</span>
                    View Issues
                </a>
            </div>
        </section>

        <!-- ‚îÄ‚îÄ Stats Row ‚îÄ‚îÄ -->
        <div class="sp-stats" role="list" aria-label="Dashboard statistics">
            <div class="sp-stat-card" role="listitem">
                <div class="sp-stat-header">
                    <div class="sp-stat-icon gold" aria-hidden="true">
                        <span class="material-symbols-outlined">pending_actions</span>
                    </div>
                    <span class="sp-stat-trend warn">
                        <span class="material-symbols-outlined">schedule</span>
                        Urgent
                    </span>
                </div>
                <div>
                    <p class="sp-stat-num">5</p>
                    <p class="sp-stat-label">Pending Approvals</p>
                </div>
            </div>
            <div class="sp-stat-card" role="listitem">
                <div class="sp-stat-header">
                    <div class="sp-stat-icon green" aria-hidden="true">
                        <span class="material-symbols-outlined">construction</span>
                    </div>
                    <span class="sp-stat-trend up">
                        <span class="material-symbols-outlined">trending_up</span>
                        +2
                    </span>
                </div>
                <div>
                    <p class="sp-stat-num">8</p>
                    <p class="sp-stat-label">Active Projects</p>
                </div>
            </div>
            <div class="sp-stat-card" role="listitem">
                <div class="sp-stat-header">
                    <div class="sp-stat-icon blue" aria-hidden="true">
                        <span class="material-symbols-outlined">campaign</span>
                    </div>
                    <span class="sp-stat-trend warn">
                        <span class="material-symbols-outlined">priority_high</span>
                        12 Open
                    </span>
                </div>
                <div>
                    <p class="sp-stat-num">12</p>
                    <p class="sp-stat-label">Community Issues</p>
                </div>
            </div>
            <div class="sp-stat-card" role="listitem">
                <div class="sp-stat-header">
                    <div class="sp-stat-icon red" aria-hidden="true">
                        <span class="material-symbols-outlined">savings</span>
                    </div>
                    <span class="sp-stat-trend up">
                        <span class="material-symbols-outlined">trending_up</span>
                        70% Used
                    </span>
                </div>
                <div>
                    <p class="sp-stat-num" id="budgetValue">‚Çπ42.8L</p>
                    <p class="sp-stat-label">Total Budget</p>
                </div>
            </div>
        </div>

        <!-- ‚îÄ‚îÄ Two-column grid ‚îÄ‚îÄ -->
        <div class="sp-grid">

            <!-- Left col -->
            <div class="sp-section">

                <!-- Attention cards -->
                <div>
                    <div class="sp-section-head">
                        <h2 class="sp-section-title">
                            <span class="sp-title-bar" aria-hidden="true"></span>
                            Requires Your Attention
                        </h2>
                        <a href="pending-approvals.html" class="sp-link-btn">
                            View All
                            <span class="material-symbols-outlined" style="font-size:.875rem" aria-hidden="true">arrow_forward</span>
                        </a>
                    </div>
                </div>

                <!-- Urgent: Fund Release -->
                <article class="sp-approval-card urgent" aria-label="Approval: Water Pipeline payment">
                    <div class="sp-approval-top">
                        <span class="sp-approval-type">Fund Release</span>
                        <span class="sp-approval-priority urgent">
                            <span class="material-symbols-outlined" aria-hidden="true">priority_high</span>
                            Urgent
                        </span>
                    </div>
                    <div class="sp-approval-body">
                        <h3 class="sp-approval-title">Water Pipeline ‚Äî Phase 2 Payment</h3>
                        <p class="sp-approval-sub">‚Çπ85,000 requested by Sharma Constructions ¬∑ Submitted 2 days ago</p>
                        <div class="sp-approval-actions">
                            <button class="sp-btn approve" onclick="handleApprove(this, 'Fund release approved!')" aria-label="Approve fund release">
                                <span class="material-symbols-outlined" aria-hidden="true">check</span>
                                Approve ‚Çπ85,000
                            </button>
                            <button class="sp-btn reject" onclick="handleReject(this, 'Fund release rejected')" aria-label="Reject fund release">
                                <span class="material-symbols-outlined" aria-hidden="true">close</span>
                                Reject
                            </button>
                        </div>
                    </div>
                </article>

                <!-- High: Issue Escalation -->
                <article class="sp-approval-card high" aria-label="Approval: Hand Pump issue escalation">
                    <div class="sp-approval-top">
                        <span class="sp-approval-type">Issue Escalation</span>
                        <span class="sp-approval-priority high">
                            <span class="material-symbols-outlined" aria-hidden="true">warning</span>
                            High
                        </span>
                    </div>
                    <div class="sp-approval-body">
                        <h3 class="sp-approval-title">Broken Hand Pump ‚Äî Ward 4</h3>
                        <p class="sp-approval-sub">142 villagers voted for priority resolution ¬∑ Reported 5 days ago</p>
                        <div class="sp-approval-actions">
                            <button class="sp-btn assign" onclick="GramSabha.showNotification('Issue assigned to Water Department', 'success')" aria-label="Assign to department">
                                <span class="material-symbols-outlined" aria-hidden="true">assignment_ind</span>
                                Assign to Dept.
                            </button>
                            <a href="community-issues.html" class="sp-btn review" aria-label="Review issue details">
                                <span class="material-symbols-outlined" aria-hidden="true">visibility</span>
                                View Details
                            </a>
                        </div>
                    </div>
                </article>

                <!-- Normal: Work Verification -->
                <article class="sp-approval-card normal" aria-label="Approval: School Boundary Wall verification">
                    <div class="sp-approval-top">
                        <span class="sp-approval-type">Work Verification</span>
                        <span class="sp-approval-priority normal">
                            <span class="material-symbols-outlined" aria-hidden="true">info</span>
                            Normal
                        </span>
                    </div>
                    <div class="sp-approval-body">
                        <h3 class="sp-approval-title">School Boundary Wall ‚Äî Final Inspection</h3>
                        <p class="sp-approval-sub">Community sign-off required for project closure ¬∑ Devi Construction</p>
                        <div class="sp-approval-actions">
                            <a href="contractor-verification.html" class="sp-btn review" aria-label="Review verification">
                                <span class="material-symbols-outlined" aria-hidden="true">fact_check</span>
                                Review &amp; Verify
                            </a>
                        </div>
                    </div>
                </article>

                <!-- Projects table -->
                <div>
                    <div class="sp-section-head" style="margin-bottom:1rem">
                        <h2 class="sp-section-title">
                            <span class="sp-title-bar" aria-hidden="true"></span>
                            Active Projects
                        </h2>
                        <a href="active-projects.html" class="sp-link-btn">
                            View All
                            <span class="material-symbols-outlined" style="font-size:.875rem" aria-hidden="true">arrow_forward</span>
                        </a>
                    </div>
                    <div class="sp-table-card">
                        <table class="sp-table" aria-label="Active construction projects">
                            <caption class="visually-hidden">List of active projects with contractor, budget and progress</caption>
                            <thead>
                                <tr>
                                    <th scope="col">Project</th>
                                    <th scope="col">Contractor</th>
                                    <th scope="col">Budget</th>
                                    <th scope="col">Progress</th>
                                    <th scope="col">Status</th>
                                    <th scope="col" aria-label="Action"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>
                                        <div class="sp-proj-cell">
                                            <div class="sp-proj-emoji" aria-hidden="true">üíß</div>
                                            <div>
                                                <p class="sp-proj-name">Water Pipeline ‚Äî Ward 4</p>
                                                <p class="sp-proj-id">PRJ-2024-1089</p>
                                            </div>
                                        </div>
                                    </td>
                                    <td style="font-size:.875rem;color:#475569;font-weight:600">Sharma Constructions</td>
                                    <td style="font-size:.875rem;font-weight:700;color:#0f172a">‚Çπ3,50,000</td>
                                    <td>
                                        <div class="sp-prog-cell">
                                            <div class="sp-prog-bar"><div class="sp-prog-fill" style="width:72%"></div></div>
                                            <span class="sp-prog-pct">72%</span>
                                        </div>
                                    </td>
                                    <td><span class="sp-status-tag in-progress">In Progress</span></td>
                                    <td>
                                        <button class="sp-table-action" onclick="window.location.href='contractor-verification.html'" aria-label="View project details">
                                            <span class="material-symbols-outlined" aria-hidden="true">visibility</span>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="sp-proj-cell">
                                            <div class="sp-proj-emoji" aria-hidden="true">üõ§Ô∏è</div>
                                            <div>
                                                <p class="sp-proj-name">School Road Repair</p>
                                                <p class="sp-proj-id">PRJ-2024-0956</p>
                                            </div>
                                        </div>
                                    </td>
                                    <td style="font-size:.875rem;color:#475569;font-weight:600">Gupta Contractors</td>
                                    <td style="font-size:.875rem;font-weight:700;color:#0f172a">‚Çπ2,25,000</td>
                                    <td>
                                        <div class="sp-prog-cell">
                                            <div class="sp-prog-bar"><div class="sp-prog-fill" style="width:45%"></div></div>
                                            <span class="sp-prog-pct">45%</span>
                                        </div>
                                    </td>
                                    <td><span class="sp-status-tag in-progress">In Progress</span></td>
                                    <td>
                                        <button class="sp-table-action" onclick="window.location.href='active-projects.html'" aria-label="View project details">
                                            <span class="material-symbols-outlined" aria-hidden="true">visibility</span>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <div class="sp-proj-cell">
                                            <div class="sp-proj-emoji" aria-hidden="true">üè´</div>
                                            <div>
                                                <p class="sp-proj-name">School Boundary Wall</p>
                                                <p class="sp-proj-id">PRJ-2024-0892</p>
                                            </div>
                                        </div>
                                    </td>
                                    <td style="font-size:.875rem;color:#475569;font-weight:600">Devi Construction</td>
                                    <td style="font-size:.875rem;font-weight:700;color:#0f172a">‚Çπ1,85,000</td>
                                    <td>
                                        <div class="sp-prog-cell">
                                            <div class="sp-prog-bar"><div class="sp-prog-fill" style="width:100%;background:linear-gradient(90deg,#22c55e,#16a34a)"></div></div>
                                            <span class="sp-prog-pct">100%</span>
                                        </div>
                                    </td>
                                    <td><span class="sp-status-tag verification">Awaiting Verification</span></td>
                                    <td>
                                        <button class="sp-table-action" onclick="window.location.href='contractor-verification.html'" aria-label="Verify completed work">
                                            <span class="material-symbols-outlined" aria-hidden="true">verified</span>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

            </div><!-- /left col -->

            <!-- Right sidebar -->
            <div class="sp-right">

                <!-- Budget Card -->
                <div class="sp-budget-card">
                    <div class="sp-budget-head">
                        <div class="sp-budget-head-row">
                            <div>
                                <h3>Budget Overview</h3>
                                <p>FY 2024‚Äì25</p>
                            </div>
                            <a href="public-ledger.html" class="sp-budget-link">Full Ledger ‚Üí</a>
                        </div>
                        <!-- SVG ring -->
                        <div class="sp-ring-wrap" aria-label="70% budget utilised" role="img">
                            <svg class="sp-ring-svg" viewBox="0 0 120 120" aria-hidden="true">
                                <circle class="sp-ring-bg" cx="60" cy="60" r="54"/>
                                <circle class="sp-ring-fg" cx="60" cy="60" r="54"/>
                            </svg>
                            <div class="sp-ring-center">
                                <span class="sp-ring-pct">70%</span>
                                <span class="sp-ring-lbl">Utilised</span>
                            </div>
                        </div>
                    </div>

                    <div class="sp-budget-rows">
                        <div class="sp-brow received">
                            <span class="sp-brow-label">Total Received</span>
                            <span class="sp-brow-value">‚Çπ42,80,000</span>
                        </div>
                        <div class="sp-brow spent">
                            <span class="sp-brow-label">Spent</span>
                            <span class="sp-brow-value">‚Çπ30,00,000</span>
                        </div>
                        <div class="sp-brow committed">
                            <span class="sp-brow-label">Committed</span>
                            <span class="sp-brow-value">‚Çπ8,25,000</span>
                        </div>
                        <div class="sp-brow avail">
                            <span class="sp-brow-label">‚úÖ Available</span>
                            <span class="sp-brow-value">‚Çπ4,55,000</span>
                        </div>
                    </div>

                    <div class="sp-breakdown">
                        <h4>Spending by Category</h4>
                        <div class="sp-breakdown-item">
                            <div class="sp-breakdown-dot" style="background:#0ea5e9" aria-hidden="true"></div>
                            <div class="sp-breakdown-meta">
                                <div class="sp-breakdown-labels">
                                    <span class="sp-breakdown-name">Water Supply</span>
                                    <span class="sp-breakdown-val">‚Çπ12,50,000</span>
                                </div>
                                <div class="sp-breakdown-bar" style="background:#e0f2fe">
                                    <div style="width:41%;height:100%;border-radius:999px;background:#0ea5e9"></div>
                                </div>
                            </div>
                        </div>
                        <div class="sp-breakdown-item">
                            <div class="sp-breakdown-dot" style="background:#f59e0b" aria-hidden="true"></div>
                            <div class="sp-breakdown-meta">
                                <div class="sp-breakdown-labels">
                                    <span class="sp-breakdown-name">Roads &amp; Paths</span>
                                    <span class="sp-breakdown-val">‚Çπ8,75,000</span>
                                </div>
                                <div class="sp-breakdown-bar" style="background:#fef3c7">
                                    <div style="width:29%;height:100%;border-radius:999px;background:#f59e0b"></div>
                                </div>
                            </div>
                        </div>
                        <div class="sp-breakdown-item">
                            <div class="sp-breakdown-dot" style="background:#8b5cf6" aria-hidden="true"></div>
                            <div class="sp-breakdown-meta">
                                <div class="sp-breakdown-labels">
                                    <span class="sp-breakdown-name">Education</span>
                                    <span class="sp-breakdown-val">‚Çπ5,25,000</span>
                                </div>
                                <div class="sp-breakdown-bar" style="background:#ede9fe">
                                    <div style="width:17%;height:100%;border-radius:999px;background:#8b5cf6"></div>
                                </div>
                            </div>
                        </div>
                        <div class="sp-breakdown-item">
                            <div class="sp-breakdown-dot" style="background:#22c55e" aria-hidden="true"></div>
                            <div class="sp-breakdown-meta">
                                <div class="sp-breakdown-labels">
                                    <span class="sp-breakdown-name">Sanitation</span>
                                    <span class="sp-breakdown-val">‚Çπ3,50,000</span>
                                </div>
                                <div class="sp-breakdown-bar" style="background:#dcfce7">
                                    <div style="width:12%;height:100%;border-radius:999px;background:#22c55e"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="sp-quick-panel">
                    <h3>Quick Actions</h3>
                    <div class="sp-quick-grid">
                        <a href="pending-approvals.html" class="sp-quick-item">
                            <div class="sp-quick-icon gold" aria-hidden="true">
                                <span class="material-symbols-outlined">task_alt</span>
                            </div>
                            <span class="sp-quick-label">Approvals</span>
                        </a>
                        <a href="community-issues.html" class="sp-quick-item">
                            <div class="sp-quick-icon blue" aria-hidden="true">
                                <span class="material-symbols-outlined">campaign</span>
                            </div>
                            <span class="sp-quick-label">View Issues</span>
                        </a>
                        <a href="contractors.html" class="sp-quick-item">
                            <div class="sp-quick-icon green" aria-hidden="true">
                                <span class="material-symbols-outlined">groups</span>
                            </div>
                            <span class="sp-quick-label">Contractors</span>
                        </a>
                        <a href="contractor-verification.html" class="sp-quick-item">
                            <div class="sp-quick-icon purple" aria-hidden="true">
                                <span class="material-symbols-outlined">verified</span>
                            </div>
                            <span class="sp-quick-label">Verify Work</span>
                        </a>
                    </div>
                </div>

            </div><!-- /right -->
        </div><!-- /grid -->
    </div><!-- /body -->
</main>
</div><!-- /layout -->

<script src="js/auth.js" data-api-base="http://127.0.0.1:5000"></script>
<script src="js/app.js"></script>
<script src="js/mobile.js"></script>
<script>
    'use strict';

    document.addEventListener('DOMContentLoaded', async function() {
        var user = GramSabha.requireAuth(['sarpanch']);
        if (!user) return;

        // Sidebar & hero
        var initials = (user.avatar || (user.name || '  ').split(' ')
            .map(function(n) { return n[0] || ''; }).join('').slice(0, 2)).toUpperCase() || 'SP';
        document.getElementById('sidebarAvatar').textContent  = initials;
        document.getElementById('sidebarUserName').textContent = user.name || '‚Äî';

        var firstName = (user.name || 'Sarpanch').split(' ')[0];
        document.getElementById('greetingText').textContent = GramSabha.getGreeting() + ', ' + firstName + ' Ji!';
        document.getElementById('heroName').textContent = 'Namaste, ' + (user.name || 'Sarpanch') + ' Ji üôè';
        var options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('dateText').textContent = new Date().toLocaleDateString('en-IN', options);

        // Village
        var villageId = user.villageId || user.village_id;
        if (villageId) {
            try {
                var village = await GramSabha.getVillage(villageId);
                var vName = village && (village.name || '') ? village.name + ' Village' : '‚Äî';
                document.getElementById('villageBadge').textContent = vName;
            } catch(e) {}

            try {
                var budget = await GramSabha.getBudget(villageId);
                if (budget && budget.totalReceived) {
                    document.getElementById('budgetValue').textContent = GramSabha.formatCurrency(budget.totalReceived);
                }
            } catch(e) {}
        }
    });

    /* Approval actions */
    function handleApprove(btn, msg) {
        var card = btn.closest('.sp-approval-card');
        card.style.transition = 'opacity .35s, transform .35s';
        card.style.opacity = '0.45';
        card.style.pointerEvents = 'none';
        // Shrink card smoothly then remove
        setTimeout(function() {
            card.style.transform = 'scale(0.97)';
            card.style.maxHeight = card.offsetHeight + 'px';
            card.style.overflow = 'hidden';
            setTimeout(function() {
                card.style.maxHeight = '0';
                card.style.marginBottom = '0';
                card.style.padding = '0';
            }, 150);
        }, 100);
        GramSabha.showNotification('‚úÖ ' + msg, 'success');
    }

    function handleReject(btn, msg) {
        var card = btn.closest('.sp-approval-card');
        card.style.transition = 'opacity .35s';
        card.style.opacity = '0.35';
        card.style.pointerEvents = 'none';
        GramSabha.showNotification('‚ùå ' + msg, 'error');
    }
</script>
</body>
</html>
